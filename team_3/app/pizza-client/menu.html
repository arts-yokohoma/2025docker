<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu - Pizza Paradise</title>
    <link rel="stylesheet" href="pizza.css">
</head>
<body>
    <header class="header">
        <nav class="nav-menu">
            <a href="pizza.html" class="logo">
                <img src="photo/main.png" alt="logo">
            </a>
            <div class="nav-cards">
                <a href="pizza.html" class="nav-card">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-label">ãƒˆãƒƒãƒ—</span>
                </a>
                <a href="home.html" class="nav-card">
                    <span class="nav-icon">ğŸ“</span>
                    <span class="nav-label">åº—èˆ—æƒ…å ±</span>
                </a>
                <a href="menu.html" class="nav-card">
                    <span class="nav-icon">ğŸ•</span>
                    <span class="nav-label">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</span>
                </a>
                <a href="about.html" class="nav-card">
                    <span class="nav-icon">â„¹ï¸</span>
                    <span class="nav-label">ä¼šç¤¾æ¦‚è¦</span>
                </a>
                <a href="myorders.html" class="nav-card">
                    <span class="nav-icon">ğŸ›’</span>
                    <span class="nav-label">æ³¨æ–‡ç¢ºèª</span>
                </a>
                <a id="authLink" href="login.html" class="nav-card">
                    <span class="nav-icon">ğŸ‘¤</span>
                    <span class="nav-label">ãƒ­ã‚°ã‚¤ãƒ³</span>
                </a>
                <a id="logoutLink" href="#" onclick="handleLogout(event)" class="nav-card" style="display: none;">
                    <span class="nav-icon">ğŸ‘¤</span>
                    <span class="nav-label" id="userNameDisplay">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</span>
                </a>
            </div>
        </nav>
    </header>

    <main class="content">
        <section style="padding:2rem; max-width:900px; margin:0 auto;">
            <h2>ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h2>
            <p>å½“åº—ã¯ãƒãƒ«ã‚²ãƒªãƒ¼ã‚¿ä¸€ç¨®é¡ã®ã¿ã®å°‚é–€åº—ã§ã™ã€‚</p>
            
            <div class="pizza-showcase" style="margin: 2rem 0;">
                <img src="photo/margherita.jpg" alt="Margherita Pizza" class="hero-pizza" >
                <p class="pizza-description">ãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒãƒˆã€ãƒ¢ãƒƒãƒ„ã‚¡ãƒ¬ãƒ©ã€ãƒã‚¸ãƒ«<br>æ–°é®®ãªææ–™ã§ä½œã‚‹æœ¬æ ¼ãƒŠãƒãƒªãƒ”ãƒƒãƒ„ã‚¡</p>
            </div>

            <div class="size-options">
                <div class="size-card">
                    <h3>S ã‚µã‚¤ã‚º</h3>
                    <p>ç›´å¾„ 20cm</p>
                    <span class="price">Â¥1,200</span>
                    <button class="order-btn" data-size="S" data-price="1200">æ³¨æ–‡ã™ã‚‹</button>
                </div>
                <div class="size-card">
                    <h3>M ã‚µã‚¤ã‚º</h3>
                    <p>ç›´å¾„ 25cm</p>
                    <span class="price">Â¥1,800</span>
                    <button class="order-btn" data-size="M" data-price="1800">æ³¨æ–‡ã™ã‚‹</button>
                </div>
                <div class="size-card">
                    <h3>L ã‚µã‚¤ã‚º</h3>
                    <p>ç›´å¾„ 30cm</p>
                    <span class="price">Â¥2,400</span>
                    <button class="order-btn" data-size="L" data-price="2400">æ³¨æ–‡ã™ã‚‹</button>
                </div>
            </div>

            <p style="margin-top: 2rem;">è¿½åŠ ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚„ãƒ‰ãƒªãƒ³ã‚¯ã¯ç¾åœ¨å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚</p>
        </section>
    </main>

    <!-- Cart UI: floating button and drawer -->
    <button id="cartToggle" class="cart-toggle" aria-label="Open cart">
        ğŸ§º <span id="cartCount" class="cart-count">0</span>
    </button>

    <aside id="cartDrawer" class="cart-drawer" aria-hidden="true">
        <div class="cart-header">
            <h3>ã‚«ãƒ¼ãƒˆ</h3>
            <button id="closeCart" class="close-cart">âœ•</button>
        </div>
        <div id="cartItems" class="cart-items">
            <!-- items inserted here -->
        </div>
        <div class="cart-footer">
            <div class="cart-total">åˆè¨ˆ: <span id="cartTotal">Â¥0</span></div>
            <div class="cart-actions">
                <button id="clearCart" class="control-btn secondary">ã‚«ãƒ¼ãƒˆã‚’ç©ºã«ã™ã‚‹</button>
                <button id="checkout" class="control-btn">æ³¨æ–‡ã™ã‚‹</button>
            </div>
        </div>
    </aside>

    <footer>
        <p>&copy; 2025 Pizza Paradise. All rights reserved.</p>
    </footer>

    <script>
        // Simple cart implementation (client-side, uses localStorage)
        (function () {
            const CART_KEY = 'pizza_cart_v1';

            function readCart() {
                try {
                    return JSON.parse(localStorage.getItem(CART_KEY) || '[]');
                } catch (e) { return []; }
            }
            function writeCart(cart) { localStorage.setItem(CART_KEY, JSON.stringify(cart)); }

            function formatYen(n) { return 'Â¥' + n.toLocaleString(); }

            function getItemDataFromCard(btn) {
                const size = btn.dataset.size || 'M';
                const price = Number(btn.dataset.price) || 0;
                return {
                    id: 'margherita_' + size,
                    name: 'ãƒãƒ«ã‚²ãƒªãƒ¼ã‚¿ (' + size + ')',
                    size: size,
                    price: price,
                    qty: 1
                };
            }

            function addToCart(item) {
                const cart = readCart();
                const existing = cart.find(i => i.id === item.id);
                if (existing) {
                    existing.qty += item.qty;
                } else {
                    cart.push(item);
                }
                writeCart(cart);
                renderCart();
            }

            function removeFromCart(id) {
                let cart = readCart();
                cart = cart.filter(i => i.id !== id);
                writeCart(cart);
                renderCart();
            }

            function clearCart() {
                writeCart([]);
                renderCart();
            }

            function renderCart() {
                const cart = readCart();
                const container = document.getElementById('cartItems');
                const count = cart.reduce((s,i)=>s+i.qty,0);
                document.getElementById('cartCount').textContent = count;

                container.innerHTML = '';
                if (cart.length === 0) {
                    container.innerHTML = '<p class="empty">ã‚«ãƒ¼ãƒˆã¯ç©ºã§ã™</p>';
                } else {
                    cart.forEach(item => {
                        const el = document.createElement('div');
                        el.className = 'cart-item';
                        el.innerHTML = `
                            <div class="ci-left">
                                <div class="ci-name">${item.name}</div>
                                <div class="ci-qty">æ•°é‡: ${item.qty}</div>
                            </div>
                            <div class="ci-right">
                                <div class="ci-price">${formatYen(item.price * item.qty)}</div>
                                <button class="remove-item" data-id="${item.id}">å‰Šé™¤</button>
                            </div>
                        `;
                        container.appendChild(el);
                    });
                }

                const total = cart.reduce((s,i)=>s + i.price * i.qty, 0);
                document.getElementById('cartTotal').textContent = formatYen(total);
            }

            // Attach to size buttons
            document.addEventListener('DOMContentLoaded', function () {
                document.querySelectorAll('.size-card .order-btn').forEach(btn => {
                    btn.addEventListener('click', function () {
                        const item = getItemDataFromCard(btn);
                        addToCart(item);
                        // open cart drawer briefly
                        openCart();
                    });
                });

                // Cart controls
                document.getElementById('cartToggle').addEventListener('click', openCart);
                document.getElementById('closeCart').addEventListener('click', closeCart);
                document.getElementById('clearCart').addEventListener('click', function () { if (confirm('ã‚«ãƒ¼ãƒˆã‚’ç©ºã«ã—ã¾ã™ã‹ï¼Ÿ')) clearCart(); });
                document.getElementById('checkout').addEventListener('click', function () {
                    const cart = readCart();
                    if (cart.length === 0) { alert('ã‚«ãƒ¼ãƒˆãŒç©ºã§ã™ã€‚'); return; }
                    // Mock checkout
                    alert('æ³¨æ–‡ã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸã€‚ç¾åœ¨ã¯ãƒ‡ãƒ¢ã®ãŸã‚æ”¯æ‰•ã„ã¯è¡Œã‚ã‚Œã¾ã›ã‚“ã€‚');
                    clearCart();
                    closeCart();
                });

                // delegate remove
                document.getElementById('cartItems').addEventListener('click', function (e) {
                    if (e.target.classList.contains('remove-item')) {
                        const id = e.target.dataset.id;
                        removeFromCart(id);
                    }
                });

                renderCart();
            });

            function openCart() {
                const drawer = document.getElementById('cartDrawer');
                drawer.classList.add('open');
                drawer.setAttribute('aria-hidden', 'false');
            }
            function closeCart() {
                const drawer = document.getElementById('cartDrawer');
                drawer.classList.remove('open');
                drawer.setAttribute('aria-hidden', 'true');
            }
        })();

        // Auth management
        const CURRENT_USER_KEY = 'pizza_current_user';

        function updateAuthUI() {
            const currentUser = localStorage.getItem(CURRENT_USER_KEY);
            const authLink = document.getElementById('authLink');
            const logoutLink = document.getElementById('logoutLink');
            const userNameDisplay = document.getElementById('userNameDisplay');

            if (currentUser) {
                const user = JSON.parse(currentUser);
                authLink.style.display = 'none';
                logoutLink.style.display = 'flex';
                userNameDisplay.textContent = user.name + ' | ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ';
            } else {
                authLink.style.display = 'flex';
                logoutLink.style.display = 'none';
            }
        }

        function handleLogout(e) {
            e.preventDefault();
            if (confirm('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
                localStorage.removeItem(CURRENT_USER_KEY);
                updateAuthUI();
                window.location.href = 'menu.html';
            }
        }

        // Update auth UI on page load
        document.addEventListener('DOMContentLoaded', function () {
            updateAuthUI();
        });
    </script>
</body>
</html>