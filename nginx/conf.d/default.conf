server {
    listen 80;
    server_name localhost;

    # Team 1 - PHP + MySQL (via Apache Server)
    location /team_1/ {
        proxy_pass http://apache_server/team_1/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Team 2 - PHP + MySQL (via Apache Server)
    location /team_2/ {
        proxy_pass http://apache_server/team_2/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location ^~ /team3/frontend/client/ {
        alias /usr/share/nginx/html/team_3/frontend/client/;
        index index.html;
        try_files $uri $uri/ /team_3/frontend/client/index.html;
    }

    location ^~ /team3/frontend/dashboard/ {
        alias /usr/share/nginx/html/team_3/frontend/dashboard/;
        index index.html;
        try_files $uri $uri/ /team_3/frontend/dashboard/index.html;
    }

    # Team 3 - Python FastAPI + PostgreSQL
    location /team_3/api/ {
        proxy_pass http://team_3_app:8000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # Team 4 - PHP + PostgreSQL (Apache)
    location /team_4/ {
        proxy_pass http://team_4_app/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Team 5 - PHP + PostgreSQL (Apache)
    location /team_5/ {
        proxy_pass http://team_5_app/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Team 6 - PHP + PostgreSQL (Apache)
    location /team_6/ {
        proxy_pass http://team_6_app/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Team 7 - Python Flask + PostgreSQL
    location /team_7/ {
        proxy_pass http://team_7_app:5000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    # Health check
    location /health {
        return 200 "healthy\n";
        add_header Content-Type text/plain;
    }
}
