<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <title>Pizza Mach</title>
    <style>
        body { font-family: sans-serif; text-align: center; background-color: #FFF8E1; padding: 20px; }
        input, select, button { padding: 12px; font-size: 16px; margin: 5px 0; width: 90%; max-width: 400px; border: 1px solid #ccc; border-radius: 5px; }
        .btn-search { background-color: #009688; color: white; border: none; cursor: pointer; }
        .form-group { background: white; padding: 20px; border-radius: 10px; max-width: 500px; margin: 0 auto; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .highlight { border: 2px solid green; background-color: #e8f5e9; }
    </style>
</head>
<body>

    <h1>ğŸ• Pizza Mach</h1>

    <div class="form-group">
        <h3>ğŸ“ á€¡á€±á€¬á€ºá€’á€«á€á€„á€ºá€›á€”á€º</h3>

        <input type="text" id="zipcode" placeholder="Zip Code (á€…á€™á€ºá€¸á€›á€”á€º: 2200012)" maxlength="7">
        <button class="btn-search" onclick="smartAddressSearch()">á€œá€­á€•á€ºá€…á€¬á€›á€¾á€¬á€™á€šá€º (Smart Search)</button>
        <br>

        <input type="text" id="cust_address" placeholder="á€œá€­á€•á€ºá€…á€¬á€¡á€•á€¼á€Šá€·á€ºá€¡á€…á€¯á€¶" readonly><br>
        
        <input type="text" id="cust_name" placeholder="á€¡á€™á€Šá€º"><br>
        <input type="text" id="cust_phone" placeholder="á€–á€¯á€”á€ºá€¸á€”á€¶á€•á€«á€á€º"><br>
        
        <select id="pizza_size">
            <option value="M">Margherita (M) - 1500Â¥</option>
            <option value="L">Margherita (L) - 2500Â¥</option>
        </select>
        <br>
        <button onclick="submitOrder()" style="background-color: #FF5722; color: white; font-weight: bold;">á€™á€¾á€¬á€šá€°á€™á€Šá€º</button>
        <div id="message"></div>
    </div>

    <script>
        // --- ğŸ”´ Presentation á€¡á€á€½á€€á€º "á€Ÿá€”á€ºá€•á€¼" Database ---
        // á€†á€›á€¬á€á€½á€±á€€á€­á€¯ á€•á€¼á€™á€šá€·á€º Zip Code á€á€½á€±á€€á€­á€¯ á€’á€®á€™á€¾á€¬ á€€á€¼á€­á€¯á€‘á€Šá€·á€ºá€‘á€¬á€¸á€•á€«
        const exactAddressDB = {
            "2200012": "Kanagawa, Yokohama, Nishi Ward, Minatomirai, 2-2-1 (Landmark Tower)",
            "1000001": "Tokyo, Chiyoda Ward, Chiyoda, 1-1 (Imperial Palace)",
            "2210835": "Kanagawa, Yokohama, Kanagawa Ward, Tsuruyacho, 2-chome (Arts College Yokohama)" 
        };

        function smartAddressSearch() {
            let zip = document.getElementById('zipcode').value;
            let addrField = document.getElementById('cust_address');

            // áá‹ á€€á€»á€½á€”á€ºá€á€±á€¬á€ºá€á€­á€¯á€· Database á€‘á€²á€™á€¾á€¬ á€›á€¾á€­á€™á€›á€¾á€­ á€¡á€›á€„á€ºá€…á€…á€ºá€™á€šá€º (á€á€­á€€á€»á€á€±á€¬ á€œá€­á€•á€ºá€…á€¬)
            if (exactAddressDB[zip]) {
                addrField.value = exactAddressDB[zip]; // á€›á€¾á€­á€›á€„á€º á€á€”á€ºá€¸á€‘á€Šá€·á€ºá€œá€­á€¯á€€á€ºá€™á€šá€º
                addrField.classList.add("highlight"); // á€¡á€…á€­á€™á€ºá€¸á€›á€±á€¬á€„á€º á€œá€„á€ºá€¸á€á€½á€¬á€¸á€¡á€±á€¬á€„á€ºá€œá€¯á€•á€ºá€™á€šá€º
            } 
            // á‚á‹ á€™á€›á€¾á€­á€›á€„á€º á€•á€¯á€¶á€™á€¾á€”á€º API á€€á€­á€¯ á€á€¯á€¶á€¸á€™á€šá€º (á€›á€•á€ºá€€á€½á€€á€ºá€œá€±á€¬á€€á€ºá€•á€² á€›á€™á€šá€º)
            else {
                fetch(`https://zipcloud.ibsnet.co.jp/api/search?zipcode=${zip}`)
                .then(response => response.json())
                .then(data => {
                    if (data.results) {
                        let result = data.results[0];
                        // API á€€ á€•á€¼á€”á€ºá€•á€±á€¸á€á€¬ + á€”á€±á€¬á€€á€ºá€€ á€¡á€­á€™á€ºá€”á€¶á€•á€«á€á€º á€€á€­á€¯á€šá€ºá€á€­á€¯á€„á€ºá€–á€¼á€Šá€·á€ºá€á€­á€¯á€„á€ºá€¸á€™á€šá€º
                        addrField.value = result.address1 + result.address2 + result.address3 + " (á€¡á€­á€™á€ºá€”á€¶á€•á€«á€á€º á€†á€€á€ºá€–á€¼á€Šá€·á€ºá€•á€«)";
                        addrField.classList.remove("highlight");
                        addrField.readOnly = false; // á€€á€­á€¯á€šá€ºá€á€­á€¯á€„á€ºá€•á€¼á€„á€ºá€œá€­á€¯á€·á€›á€¡á€±á€¬á€„á€º á€–á€½á€„á€·á€ºá€•á€±á€¸á€™á€šá€º
                    } else {
                        alert("á€œá€­á€•á€ºá€…á€¬ á€™á€á€½á€±á€·á€•á€«á‹ á€€á€­á€¯á€šá€ºá€á€­á€¯á€„á€º á€›á€­á€¯á€€á€ºá€‘á€Šá€·á€ºá€•á€±á€¸á€•á€«á‹");
                        addrField.readOnly = false;
                    }
                });
            }
        }

        // --- á€¡á€±á€¬á€ºá€’á€«á€á€„á€ºá€á€¼á€„á€ºá€¸ Function (á€•á€¯á€¶á€™á€¾á€”á€ºá€¡á€á€­á€¯á€„á€ºá€¸) ---
        function submitOrder() {
            const name = document.getElementById('cust_name').value;
            const phone = document.getElementById('cust_phone').value;
            const address = document.getElementById('cust_address').value;
            const size = document.getElementById('pizza_size').value;
            const msgDiv = document.getElementById('message');

            if(!name || !address || !phone) { alert("á€¡á€á€»á€€á€ºá€¡á€œá€€á€º á€•á€¼á€Šá€·á€ºá€…á€¯á€¶á€¡á€±á€¬á€„á€º á€–á€¼á€Šá€·á€ºá€•á€«"); return; }

            let formData = new FormData();
            formData.append('name', name);
            formData.append('phone', phone);
            formData.append('address', address);
            formData.append('size', size);

            fetch('check_order.php', { method: 'POST', body: formData })
            .then(res => res.json())
            .then(data => {
                msgDiv.innerHTML = data.message;
                msgDiv.style.color = (data.status === 'success') ? "green" : "red";
            });
        }
    </script>
</body>
</html>