"use strict";(self.webpackChunkadmin_client=self.webpackChunkadmin_client||[]).push([[348],{867:(e,t,a)=>{a.d(t,{jE:()=>r,st:()=>l,ul:()=>o,zZ:()=>s});var n=a(9722),c=a(6943),i=a(1759);const r=async e=>{const{access_token:t,token_type:a}=e;try{const e=await n.A.get("".concat(c.B5,"/category"),{headers:{Authorization:"".concat(a," ").concat(t)}});return(0,i.y)(e,"\u30ab\u30c6\u30b4\u30ea\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(r){(0,i.h)(r)}},o=async(e,t)=>{const{access_token:a,token_type:r}=e;try{const e=await n.A.post("".concat(c.B5,"/category/delete"),t,{headers:{Authorization:"".concat(r," ").concat(a)}});return(0,i.y)(e,"\u3042\u308b\u30e1\u30cb\u30e5\u30fc\u4f7f\u7528\u3059\u308b\u304b\u3089\u30ab\u30c6\u30b4\u30ea\u306e\u524a\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(o){(0,i.h)(o)}},s=async(e,t)=>{const{access_token:a,token_type:r}=e;try{const e=await n.A.post("".concat(c.B5,"/category/create"),t,{headers:{Authorization:"".concat(r," ").concat(a)}});return(0,i.y)(e,"\u30e1\u30cb\u30e5\u30fc\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(o){(0,i.h)(o)}},l=async(e,t,a)=>{const{access_token:r,token_type:o}=e;try{const e=await n.A.put("".concat(c.B5,"/category/update/").concat(t),a,{headers:{Authorization:"".concat(o," ").concat(r)}});return(0,i.y)(e,"\u30e1\u30cb\u30e5\u30fc\u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(s){(0,i.h)(s)}}},2505:(e,t,a)=>{var n=a(4994);t.A=void 0;var c=n(a(39)),i=a(579);t.A=(0,c.default)((0,i.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},6164:(e,t,a)=>{var n=a(4994);t.A=void 0;var c=n(a(39)),i=a(579);t.A=(0,c.default)((0,i.jsx)("path",{d:"M19 13H5v-2h14z"}),"Remove")},6782:(e,t,a)=>{a.d(t,{ES:()=>o,fd:()=>l,kZ:()=>r,lH:()=>s});var n=a(9722),c=a(6943),i=a(1759);const r=async()=>{try{const e=await n.A.get("".concat(c.B5,"/menu"));return(0,i.y)(e,"\u30e1\u30cb\u30e5\u30fc\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(e){(0,i.h)(e)}},o=async(e,t)=>{const{access_token:a,token_type:r}=e;try{const e=await n.A.post("".concat(c.B5,"/menu/create"),t,{headers:{Authorization:"".concat(r," ").concat(a)}});return(0,i.y)(e,"\u30e1\u30cb\u30e5\u30fc\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(o){(0,i.h)(o)}},s=async(e,t,a)=>{const{access_token:r,token_type:o}=e;try{const e=await n.A.put("".concat(c.B5,"/menu/update/").concat(t),a,{headers:{Authorization:"".concat(o," ").concat(r)}});return(0,i.y)(e,"\u30e1\u30cb\u30e5\u30fc\u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(s){(0,i.h)(s)}},l=async(e,t)=>{const{access_token:a,token_type:r}=e;try{const e=await n.A.post("".concat(c.B5,"/menu/delete"),t,{headers:{Authorization:"".concat(r," ").concat(a)}});return(0,i.y)(e,"\u30e1\u30cb\u30e5\u30fc\u306e\u524a\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(o){(0,i.h)(o)}}},8348:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var n=a(9379),c=a(5043),i=a(6446),r=a(5865),o=a(3336),s=a(3216),l=a(7784),d=a(4225),h=a(6990),u=a(8903),m=a(7392),g=a(1906),y=a(707),A=a(1962),p=a(2505),v=a(6164),x=a(867),j=a(8729),_=a(579);const f=e=>{var t;let{formData:a,onChange:n,onSubmit:o,handleCancel:s,isSubmitting:f,submitLabel:k}=e;const[z,b]=(0,c.useState)(""),[C,w]=(0,c.useState)([]),[S,B]=(0,c.useState)(a.sizes||[]),[E,T]=(0,c.useState)({}),[W,Y]=(0,c.useState)([]),{callApiWithToken:D}=(0,j.A)(),H=a.category_id||(null===(t=a.category)||void 0===t?void 0:t.id)||"";(0,c.useEffect)(()=>{b(a.image_url||"")},[a.image_url]),(0,c.useEffect)(()=>{B(a.sizes||[])},[a.sizes]),(0,c.useEffect)(()=>{(async()=>{const e=await D(x.jE);w(e)})()},[D]);const I=(e,t,a)=>{const c=[...S];c[e][t]=a,B(c),n({target:{name:"sizes",value:c}})};return(0,_.jsxs)(i.A,{component:"form",noValidate:!0,autoComplete:"off",children:[(0,_.jsx)(l.A,{fullWidth:!0,label:"\u540d",name:"name",value:a.name,onChange:n,margin:"normal",error:!!E.name,helperText:E.name||" "}),(0,_.jsx)(l.A,{fullWidth:!0,label:"\u8aac\u660e",name:"description",value:a.description,onChange:n,margin:"normal",multiline:!0,error:!!E.description,helperText:E.description||" "}),(0,_.jsxs)(i.A,{marginY:2,children:[(0,_.jsx)(r.A,{children:"\u30ab\u30c6\u30b4\u30ea:"}),(0,_.jsx)(d.A,{fullWidth:!0,value:H,onChange:e=>n({target:{name:"category_id",value:e.target.value}}),name:"category_id",error:!!E.category_id,children:C.map(e=>(0,_.jsx)(h.A,{value:e.id,children:e.category_name},e.id))}),E.category_id&&(0,_.jsx)(r.A,{color:"error",variant:"body2",mt:.5,children:E.category_id})]}),(0,_.jsxs)(i.A,{marginY:2,children:[(0,_.jsx)(r.A,{children:"\u30a4\u30e1\u30fc\u30b8:"}),z&&(0,_.jsx)("img",{src:z,alt:"preview",style:{width:150,height:150,objectFit:"cover",marginBottom:8}}),(0,_.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onloadend=()=>{b(e.result),n({target:{name:"image_url",value:e.result}})},e.readAsDataURL(t)}}})]}),(0,_.jsxs)(i.A,{marginY:2,children:[(0,_.jsx)(r.A,{children:"\u30b5\u30a4\u30ba:"}),E.sizes&&(0,_.jsx)(r.A,{color:"error",variant:"body2",mb:1,children:E.sizes}),S.map((e,t)=>{var a,c,i,r,o,s;return(0,_.jsxs)(u.Ay,{container:!0,spacing:1,alignItems:"center",marginBottom:1,children:[(0,_.jsx)(u.Ay,{item:!0,xs:2,children:(0,_.jsx)(l.A,{label:"\u30b5\u30a4\u30ba",value:e.size,onChange:e=>I(t,"size",e.target.value),error:!(null===(a=W[t])||void 0===a||!a.size),helperText:(null===(c=W[t])||void 0===c?void 0:c.size)||" "})}),(0,_.jsx)(u.Ay,{item:!0,xs:3,children:(0,_.jsx)(l.A,{label:"\u4fa1\u683c",type:"number",value:e.price,onChange:e=>I(t,"price",Number(e.target.value)),error:!(null===(i=W[t])||void 0===i||!i.price),helperText:(null===(r=W[t])||void 0===r?void 0:r.price)||" "})}),(0,_.jsx)(u.Ay,{item:!0,xs:5,children:(0,_.jsx)(l.A,{label:"\u8aac\u660e",value:e.description,onChange:e=>I(t,"description",e.target.value),error:!(null===(o=W[t])||void 0===o||!o.description),helperText:(null===(s=W[t])||void 0===s?void 0:s.description)||" "})}),(0,_.jsx)(u.Ay,{item:!0,xs:2,children:(0,_.jsx)(m.A,{onClick:()=>(e=>{const t=S.filter((t,a)=>a!==e);B(t),n({target:{name:"sizes",value:t}});const a=W.filter((t,a)=>a!==e);Y(a)})(t),children:(0,_.jsx)(v.A,{})})})]},t)}),(0,_.jsx)(g.A,{variant:"outlined",startIcon:(0,_.jsx)(p.A,{}),onClick:()=>{const e=[...S,{size:"",price:"",description:""}];B(e),n({target:{name:"sizes",value:e}}),Y([...W,{}])},children:"\u8ffd\u52a0\u30b5\u30a4\u30ba"})]}),(0,_.jsxs)(i.A,{marginY:2,children:[(0,_.jsx)(r.A,{children:"\u4eba\u6c17:"}),(0,_.jsx)(y.A,{control:(0,_.jsx)(A.A,{checked:!!a.is_liked,onChange:e=>n({target:{name:"is_liked",value:e.target.checked}})}),label:"\u4eba\u6c17"})]}),(0,_.jsxs)(i.A,{marginY:2,sx:{display:"flex",gap:1},children:[(0,_.jsx)(g.A,{variant:"contained",color:"primary",onClick:()=>{let e={},t=[];a.name.trim()||(e.name="\u6599\u7406\u540d\u306f\u5fc5\u9808\u3067\u3059"),a.description.trim()||(e.description="\u8aac\u660e\u306f\u5fc5\u9808\u3067\u3059"),a.category_id||(e.category_id="\u30ab\u30c6\u30b4\u30ea\u306f\u5fc5\u9808\u3067\u3059"),0===S.length?e.sizes="\u30b5\u30a4\u30ba\u3092\u5c11\u306a\u304f\u3068\u30821\u3064\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044":S.forEach((e,a)=>{let n={};e.size.trim()||(n.size="\u30b5\u30a4\u30ba\u306f\u5fc5\u9808\u3067"),e.description.trim()||(n.description="\u8aac\u660e\u306f\u5fc5\u9808\u3067\u3059"),(""===e.price||isNaN(e.price))&&(n.price="\u4fa1\u683c\u306f\u6570\u5024\u3067\u3001\u5fc5\u9808\u9805\u76ee\u3067\u3059"),t[a]=n}),T(e),Y(t);const n=t.some(e=>Object.keys(e).length>0);0!==Object.keys(e).length||n||o()},disabled:f,sx:{textTransform:"none"},children:k}),(0,_.jsx)(g.A,{variant:"contained",color:"secondary",onClick:s,sx:{textTransform:"none"},children:"\u30ad\u30e3\u30f3\u30bb\u30eb"})]})]})};var k=a(6782);const z=()=>{var e;const t=(0,s.Zp)(),a=(0,s.zy)(),{callApiWithToken:l}=(0,j.A)(),d=null===(e=a.state)||void 0===e?void 0:e.initialData,[h,u]=(0,c.useState)({name:"",description:"",category_id:"",is_liked:!1,sizes:[],image_url:""}),[m,g]=(0,c.useState)(!1),[y,A]=(0,c.useState)("");(0,c.useEffect)(()=>{if(d){var e;const t=d.category_id||(null===(e=d.category)||void 0===e?void 0:e.id)||"";u((0,n.A)((0,n.A)({},d),{},{category_id:t}))}},[d]);return(0,_.jsxs)(i.A,{children:[(0,_.jsx)(r.A,{variant:"h4",gutterBottom:!0,children:d?"\u270f\ufe0f \u5909\u66f4":"\u2795 \u8ffd\u52a0"}),(0,_.jsxs)(o.A,{sx:{p:3},children:[(0,_.jsx)(f,{formData:h,onChange:e=>{const{name:t,value:a}=e.target;u(e=>(0,n.A)((0,n.A)({},e),{},{[t]:a}))},onSubmit:async()=>{g(!0),A("");try{null!==d&&void 0!==d&&d.id?(await l(k.lH,d.id,h),t("/menu")):(await l(k.ES,h),t("/menu"))}catch(e){A((null===e||void 0===e?void 0:e.message)||"API\u547c\u3076\u3068\u304d\u767a\u751f\u3057\u305f")}finally{g(!1)}},handleCancel:()=>t("/menu"),isSubmitting:m,submitLabel:d?"\u5909\u66f4":"\u8ffd\u52a0"}),y&&(0,_.jsx)(r.A,{color:"error",mt:2,children:y})]})]})}}}]);
//# sourceMappingURL=348.6d730c4e.chunk.js.map