"use strict";(self.webpackChunkadmin_client=self.webpackChunkadmin_client||[]).push([[934],{386:(e,t,n)=>{n.d(t,{Kh:()=>o,by:()=>l,hU:()=>i});var a=n(9722),r=n(6943),s=n(1759);const i=async e=>{const{access_token:t,token_type:n}=e;try{const e=await a.A.get("".concat(r.B5,"/user-admin"),{headers:{Authorization:"".concat(n," ").concat(t)}});return(0,s.y)(e,"\u30e6\u30fc\u30b6\u30fc\u306e\u53d6\u5f97\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(i){(0,s.h)(i)}},l=async(e,t)=>{const{access_token:n,token_type:i}=e;try{const e=await a.A.post("".concat(r.B5,"/user-admin/create"),t,{headers:{Authorization:"".concat(i," ").concat(n)}});return(0,s.y)(e,"\u30e6\u30fc\u30b6\u30fc\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(l){(0,s.h)(l)}},o=async(e,t)=>{const{access_token:n,token_type:i}=e;try{const e=await a.A.post("".concat(r.B5,"/user-admin/delete/").concat(t.id),t,{headers:{Authorization:"".concat(i," ").concat(n)}});return(0,s.y)(e,"\u30e6\u30fc\u30b6\u30fc\u306e\u524a\u9664\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}catch(l){(0,s.h)(l)}}},3934:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var a=n(5043),r=n(6446),s=n(5865),i=n(35),l=n(6600),o=n(5316),c=n(9347),d=n(1906),h=n(6559),x=n(7948),u=n(5456),A=n(6943),m=n(579);const y=e=>{let{users:t,loading:n,onDelete:i}=e;const[l,o]=(0,a.useState)(10),c=[{field:"id",headerName:"ID",width:90},{field:"name",headerName:"\u30e6\u30fc\u30b6\u30fc\u540d",width:200},{field:"email",headerName:"\u30e1\u30fc\u30eb",width:200},{field:"role_type",headerName:"\u6a29\u9650",width:150,renderCell:e=>{const t=A.zF.find(t=>t.value===e.row.role_type);return(0,m.jsx)(s.A,{variant:"body2",children:t?t.label:"\u30d0\u30a4\u30c8"})}},{field:"actions",headerName:"\u64cd\u4f5c",width:160,sortable:!1,filterable:!1,renderCell:e=>1===e.row.role_type?(0,m.jsx)(s.A,{variant:"body2",color:"text.secondary"}):(0,m.jsx)(r.A,{sx:{display:"flex",gap:1},children:(0,m.jsx)(d.A,{variant:"outlined",color:"error",size:"small",onClick:()=>i(e.row.id),children:"\u524a\u9664"})})}];return(0,m.jsx)(r.A,{sx:{height:650,width:"100%"},children:(0,m.jsx)(u.z,{rows:t||[],columns:c,pageSize:l,onPageSizeChange:e=>o(e),rowsPerPageOptions:[10,50,100],pagination:!0,loading:n,getRowId:e=>e.id,disableSelectionOnClick:!0})})};var j=n(7784),p=n(3216);const f=e=>{let{filterName:t,setFilterName:n}=e;const a=(0,p.Zp)();return(0,m.jsxs)(r.A,{sx:{display:"flex",gap:2,mb:2,alignItems:"center"},children:[(0,m.jsx)(r.A,{sx:{mb:2,width:300},children:(0,m.jsx)(j.A,{fullWidth:!0,label:"\u30e6\u30fc\u30b6\u30fc\u540d\u691c\u7d22",value:t,onChange:e=>n(e.target.value),size:"small"})}),(0,m.jsx)(r.A,{sx:{flexGrow:1}}),(0,m.jsx)(d.A,{variant:"contained",color:"primary",onClick:()=>a("/user/form"),sx:{textTransform:"none",boxShadow:2},children:"\u2795 \u8ffd\u52a0"})]})};var w=n(386),g=n(8729);const k=()=>{const[e,t]=(0,a.useState)([]),[n,u]=(0,a.useState)(!1),[A,j]=(0,a.useState)(""),[p,k]=(0,a.useState)(!1),[C,v]=(0,a.useState)(null),[b,S]=(0,a.useState)(!1),[_,z]=(0,a.useState)(""),{callApiWithToken:N}=(0,g.A)();(0,a.useEffect)(()=>{(async()=>{u(!0);try{const e=await N(w.hU);t(e||[])}catch(e){console.error("Failed to fetch users",e)}finally{u(!1)}})()},[N]);const I=e.filter(e=>e.name.toLowerCase().includes(A.toLowerCase()));return(0,m.jsxs)(r.A,{sx:{p:3},children:[(0,m.jsx)(s.A,{variant:"h4",gutterBottom:!0,children:"\u30e6\u30fc\u30b6\u30fc"}),(0,m.jsx)(f,{filterName:A,setFilterName:j}),(0,m.jsx)(y,{users:I,loading:n,onDelete:e=>{v(e),k(!0)}}),(0,m.jsxs)(i.A,{open:p,onClose:()=>k(!1),children:[(0,m.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,m.jsx)(h.A,{color:"warning"}),"\u78ba\u8a8d"]}),(0,m.jsx)(o.A,{children:(0,m.jsx)(s.A,{children:"\u30e6\u30fc\u30b6\u30fc\u306e\u4ef6\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"})}),(0,m.jsxs)(c.A,{children:[(0,m.jsx)(d.A,{onClick:()=>k(!1),children:"\u30ad\u30e3\u30f3\u30bb\u30eb"}),(0,m.jsx)(d.A,{onClick:async()=>{if(C)try{u(!0),await N(w.Kh,{id:C}),t(e=>e.filter(e=>e.id!==C)),k(!1),v(null)}catch(e){z((null===e||void 0===e?void 0:e.message)||"\u524a\u9664\u306e\u5931\u6557"),S(!0)}finally{u(!1)}},color:"error",variant:"contained",disabled:n,children:"\u524a\u9664"})]})]}),(0,m.jsxs)(i.A,{open:b,onClose:()=>S(!1),children:[(0,m.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,m.jsx)(x.A,{color:"error"}),"\u524a\u9664\u30a8\u30e9\u30fc"]}),(0,m.jsx)(o.A,{children:(0,m.jsx)(s.A,{color:"error",children:_})}),(0,m.jsx)(c.A,{children:(0,m.jsx)(d.A,{onClick:()=>S(!1),color:"primary",children:"OK"})})]})]})}}}]);
//# sourceMappingURL=934.09fdee2c.chunk.js.map