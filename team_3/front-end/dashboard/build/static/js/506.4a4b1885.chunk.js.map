{"version":3,"file":"static/js/506.4a4b1885.chunk.js","mappings":"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","sources":["components/Order/OrderTable.js","components/Order/OrderFillter.js","pages/admin/OrderPage.js","actions/CallApi/OrderFetch.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { DataGrid } from \"@mui/x-data-grid\";\r\nimport { FormControl, MenuItem, Select } from \"@mui/material\";\r\nimport { statusOptions } from \"../../utilities/constant\";\r\n\r\nconst OrderTable = ({ orders, updatingId, onStatusChange }) => {\r\n  const [pageSize, setPageSize] = useState(10);\r\n\r\n  const columns = [\r\n    { field: \"order_code\", headerName: \"オーダー番号\", width: 160 },\r\n    { field: \"customer_name\", headerName: \"名前\", width: 120 },\r\n    { field: \"phone\", headerName: \"電話番号\", width: 130 },\r\n    {\r\n      field: \"total_price\",\r\n      headerName: \"合計\",\r\n      width: 120,\r\n      valueGetter: (params) => `${params.row.total_price} 円`,\r\n    },\r\n    { field: \"order_date\", headerName: \"配達時間\", width: 120 },\r\n\r\n    // // ✅ NEW: số món\r\n    // {\r\n    //   field: \"items_count\",\r\n    //   headerName: \"点数\",\r\n    //   width: 80,\r\n    //   valueGetter: (params) => params.row.items?.length ?? 0,\r\n    //   sortable: false,\r\n    // },\r\n\r\n    {\r\n      field: \"items\",\r\n      headerName: \"商品\",\r\n      width: 200,\r\n      sortable: false,\r\n      renderCell: (params) => {\r\n        const items = params.row.items || [];\r\n        return (\r\n          <div style={{ whiteSpace: \"normal\", lineHeight: \"1.4\", padding: \"4px 0\" }}>\r\n            {items.length === 0\r\n              ? \"-\"\r\n              : items.map((it) => (\r\n                  <div key={it.id}>\r\n                    {it.menu_name} - Size: {it.size} × {it.quantity}\r\n                  </div>\r\n                ))}\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n\r\n    {\r\n      field: \"note\",\r\n      headerName: \"要望\",\r\n      width: 220,\r\n      renderCell: (params) => (\r\n        <div style={{ whiteSpace: \"normal\", wordWrap: \"break-word\", lineHeight: \"1.4\", padding: \"4px 0\" }}>\r\n          {params.value || \"\"}\r\n        </div>\r\n      ),\r\n    },\r\n\r\n    {\r\n      field: \"status\",\r\n      headerName: \"状況\",\r\n      width: 180,\r\n      renderCell: (params) => {\r\n        const currentStatus = statusOptions.find((opt) => opt.value === params.row.status);\r\n        return (\r\n          <FormControl fullWidth size=\"small\" disabled={updatingId === params.row.id}>\r\n            <Select\r\n              value={params.row.status}\r\n              onChange={(e) => onStatusChange(params.row.id, e.target.value)}\r\n              sx={{\r\n                backgroundColor: currentStatus ? currentStatus.color + \"40\" : \"transparent\",\r\n                color: currentStatus ? currentStatus.color : \"inherit\",\r\n                fontWeight: \"bold\",\r\n                borderRadius: 1,\r\n              }}\r\n            >\r\n              {statusOptions.map((opt) => (\r\n                <MenuItem key={opt.value} value={opt.value} sx={{ color: opt.color }}>\r\n                  {opt.label}\r\n                </MenuItem>\r\n              ))}\r\n            </Select>\r\n          </FormControl>\r\n        );\r\n      },\r\n    },\r\n\r\n    {\r\n      field: \"create_time\",\r\n      headerName: \"作成日付\",\r\n      width: 120,\r\n      valueGetter: (params) => params.row.create_time?.slice(0, 10),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div style={{ height: 450, width: \"100%\" }}>\r\n      <DataGrid\r\n        rows={orders || []}\r\n        columns={columns}\r\n        pageSize={pageSize}\r\n        onPageSizeChange={(newPageSize) => setPageSize(newPageSize)}\r\n        rowsPerPageOptions={[10, 50, 100]}\r\n        pagination\r\n        getRowId={(row) => row.id}\r\n        disableSelectionOnClick\r\n        getRowHeight={() => \"auto\"}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderTable;\r\n","import React from \"react\";\r\nimport { Box, TextField, FormControl, InputLabel, Select, MenuItem, Button } from \"@mui/material\";\r\nimport { statusOptions } from \"../../utilities/constant\";\r\n\r\nconst OrderFilter = ({ filterDate, setFilterDate, filterStatus, setFilterStatus, onReset }) => {\r\n\r\n  return (\r\n    <Box sx={{ display: \"flex\", gap: 2, mb: 2 }}>\r\n      <TextField\r\n        label=\"日付\"\r\n        type=\"date\"\r\n        value={filterDate}\r\n        onChange={(e) => setFilterDate(e.target.value)}\r\n        InputLabelProps={{ shrink: true }}\r\n        size=\"small\"\r\n      />\r\n\r\n      <FormControl size=\"small\" sx={{ minWidth: 180 }}>\r\n        <InputLabel>状況</InputLabel>\r\n        <Select\r\n          label=\"状況\"\r\n          value={filterStatus}\r\n          onChange={(e) => setFilterStatus(e.target.value)}\r\n        >\r\n          <MenuItem value=\"\">全部</MenuItem>\r\n          {statusOptions.map((opt) => (\r\n            <MenuItem key={opt.value} value={opt.value}>\r\n              {opt.label}\r\n            </MenuItem>\r\n          ))}\r\n        </Select>\r\n      </FormControl>\r\n\r\n      <Button variant=\"outlined\" onClick={onReset}>\r\n        Reset Filter\r\n      </Button>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default OrderFilter;\r\n","import React, { useEffect, useState, useMemo } from \"react\";\r\nimport { Typography, Box } from \"@mui/material\";\r\nimport { OrderTable, OrderFillter } from \"../../components/Order\";\r\nimport { fetchOrders, updateOrderStatus } from \"../../actions/CallApi/OrderFetch.js\";\r\nimport { useAuth } from \"../../context/AuthContext\";\r\n\r\nconst OrderPage = () => {\r\n  const [orders, setOrders] = useState([]);\r\n  const [filterDate, setFilterDate] = useState(\"\");\r\n  const [filterStatus, setFilterStatus] = useState(\"\");\r\n  const [updatingId, setUpdatingId] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const { callApiWithToken } = useAuth();\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const data = await callApiWithToken(fetchOrders);\r\n        setOrders(data || []);\r\n      } catch (error) {\r\n        console.error(\"API呼ぶエーラー発生:\", error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [callApiWithToken]);\r\n\r\n  const handleStatusChange = async (id, status) => {\r\n    setUpdatingId(id);\r\n    try {\r\n      await callApiWithToken(updateOrderStatus, id, {status});\r\n      setOrders((prev) =>\r\n        prev.map((item) =>\r\n          item.id === id ? { ...item, status: status } : item\r\n        )\r\n      );\r\n    } catch (error) {\r\n      console.error(\"API呼ぶエーラー発生:\", error);\r\n    } finally {\r\n      setUpdatingId(null);\r\n    }\r\n  };\r\n\r\n  const filteredOrders = useMemo(() => {\r\n    return orders.filter((item) => {\r\n      const matchDate = filterDate ? item.create_time.startsWith(filterDate) : true;\r\n      const matchStatus = filterStatus ? item.status === filterStatus : true;\r\n      return matchDate && matchStatus;\r\n    });\r\n  }, [orders, filterDate, filterStatus]);\r\n\r\n  return (\r\n    <Box>\r\n      <Typography variant=\"h4\" gutterBottom>\r\n        オーダー\r\n      </Typography>\r\n\r\n      <OrderFillter\r\n        filterDate={filterDate}\r\n        setFilterDate={setFilterDate}\r\n        filterStatus={filterStatus}\r\n        setFilterStatus={setFilterStatus}\r\n        onReset={() => {\r\n          setFilterDate(\"\");\r\n          setFilterStatus(\"\");\r\n        }}\r\n      />\r\n\r\n      {loading ? (\r\n        <Typography>データを読み込んでいます...</Typography>\r\n      ) : (\r\n        <OrderTable\r\n          orders={filteredOrders}\r\n          updatingId={updatingId}\r\n          onStatusChange={handleStatusChange}\r\n        />\r\n      )}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default OrderPage;\r\n","import axios from \"axios\";\r\nimport { API_USER } from \"../../utilities/constant\";import { handleApiResponse, handleApiError } from \"../../utilities/handlerApi\";\r\n\r\n\r\nexport const fetchOrders = async (auth) => {\r\n  const { access_token, token_type } = auth;\r\n  try {\r\n    const response = await axios.get(`${API_USER}/order`,\r\n       {\r\n        headers: {\r\n          Authorization: `${token_type} ${access_token}`,\r\n        },\r\n      }\r\n    );\r\n    return handleApiResponse(response, \"オーダーの取得に失敗しました。\");\r\n  } catch (err) {\r\n    handleApiError(err);\r\n  }\r\n};\r\n\r\nexport const fetchRevenue = async (auth, year) => {\r\n  const { access_token, token_type } = auth;\r\n  try {\r\n    const response = await axios.get(`${API_USER}/order/revenue?year=${year}`,\r\n       {\r\n        headers: {\r\n          Authorization: `${token_type} ${access_token}`,\r\n        },\r\n      }\r\n    );\r\n    return handleApiResponse(response, \"オーダーの取得に失敗しました。\");\r\n  } catch (err) {\r\n    handleApiError(err);\r\n  }\r\n};\r\n\r\n\r\nexport const updateOrderStatus = async (auth, id, data) => {\r\n  const { access_token, token_type } = auth;\r\n  try {\r\n    const response = await axios.post(\r\n      `${API_USER}/order/update/${id}`,\r\n      data,\r\n      {\r\n        headers: {\r\n          Authorization: `${token_type} ${access_token}`,\r\n        },\r\n      }\r\n    );\r\n    return handleApiResponse(response, \"オーダーの更新に失敗しました。\");\r\n  } catch (err) {\r\n    handleApiError(err);\r\n  }\r\n};\r\n"],"names":["_ref","orders","updatingId","onStatusChange","pageSize","setPageSize","useState","columns","field","headerName","width","valueGetter","params","concat","row","total_price","sortable","renderCell","items","_jsx","style","whiteSpace","lineHeight","padding","children","length","map","it","_jsxs","menu_name","size","quantity","id","wordWrap","value","currentStatus","statusOptions","find","opt","status","FormControl","fullWidth","disabled","Select","onChange","e","target","sx","backgroundColor","color","fontWeight","borderRadius","MenuItem","label","_params$row$create_ti","create_time","slice","height","DataGrid","rows","onPageSizeChange","newPageSize","rowsPerPageOptions","pagination","getRowId","disableSelectionOnClick","getRowHeight","filterDate","setFilterDate","filterStatus","setFilterStatus","onReset","Box","display","gap","mb","TextField","type","InputLabelProps","shrink","minWidth","InputLabel","Button","variant","onClick","OrderPage","setOrders","setUpdatingId","loading","setLoading","callApiWithToken","useAuth","useEffect","async","data","fetchOrders","error","console","fetchData","filteredOrders","useMemo","filter","item","matchDate","startsWith","matchStatus","Typography","gutterBottom","OrderFillter","OrderTable","updateOrderStatus","prev","_objectSpread","access_token","token_type","auth","response","axios","get","API_USER","headers","Authorization","handleApiResponse","err","handleApiError","fetchRevenue","year","post"],"sourceRoot":""}